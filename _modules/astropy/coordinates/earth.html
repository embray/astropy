<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>astropy.coordinates.earth &mdash; Astropy v0.4rc3.dev9435</title>
    
    <link rel="stylesheet" href="../../../_static/bootstrap-astropy.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '0.4rc3.dev9435',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/sidebar.js"></script>
    <link rel="shortcut icon" href="../../../_static/astropy_logo.ico"/>
    <link rel="top" title="Astropy v0.4rc3.dev9435" href="../../../index.html" />
    <link rel="up" title="Module code" href="../../index.html" />
<link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'>
<script type="text/javascript" src="../../../_static/copybutton.js"></script>


  </head>
  <body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../../../index.html"><span id="logotext1">astro</span><span id="logotext2">py</span><span id="logotext3">:docs</span></a>
  <ul>
    <li><a class="homelink" title="Astropy Homepage" href="http://www.astropy.org"></a></li>
    <li><a title="General Index" href="../../../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../../../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../../../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li>
	<a href="../../../index.html">Astropy v0.4rc3.dev9435</a>
	 &raquo;
      </li>
      <li><a href="../../index.html" accesskey="U">Module code</a> &raquo;</li>
      
       
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <h1>Source code for astropy.coordinates.earth</h1><div class="highlight"><pre>
<span class="c"># Licensed under a 3-clause BSD style license - see LICENSE.rst</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="p">(</span><span class="n">absolute_import</span><span class="p">,</span> <span class="n">division</span><span class="p">,</span> <span class="n">print_function</span><span class="p">,</span>
                        <span class="n">unicode_literals</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">units</span> <span class="k">as</span> <span class="n">u</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">Longitude</span><span class="p">,</span> <span class="n">Latitude</span>

<span class="k">try</span><span class="p">:</span>
    <span class="c"># Not guaranteed available at setup time.</span>
    <span class="kn">from</span> <span class="nn">..time</span> <span class="kn">import</span> <span class="n">erfa_time</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">_ASTROPY_SETUP_</span><span class="p">:</span>
        <span class="k">raise</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;EarthLocation&#39;</span><span class="p">]</span>

<span class="c"># translation between ellipsoid names and corresponding number used in ERFA</span>
<span class="n">ELLIPSOIDS</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;WGS84&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;GRS80&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s">&#39;WGS72&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">}</span>


<span class="k">def</span> <span class="nf">_check_ellipsoid</span><span class="p">(</span><span class="n">ellipsoid</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s">&#39;WGS84&#39;</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">ellipsoid</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">ellipsoid</span> <span class="o">=</span> <span class="n">default</span>
    <span class="k">if</span> <span class="n">ellipsoid</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ELLIPSOIDS</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;Ellipsoid {0} not among known ones ({1})&#39;</span>
                         <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ellipsoid</span><span class="p">,</span> <span class="n">ELLIPSOIDS</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
    <span class="k">return</span> <span class="n">ellipsoid</span>


<div class="viewcode-block" id="EarthLocation"><a class="viewcode-back" href="../../../api/astropy.coordinates.EarthLocation.html#astropy.coordinates.EarthLocation">[docs]</a><span class="k">class</span> <span class="nc">EarthLocation</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">Quantity</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Location on Earth.</span>

<span class="sd">    Initialization is first attempted assuming geocentric (x, y, z) coordinates</span>
<span class="sd">    are given; if that fails, another attempt is made assuming geodetic</span>
<span class="sd">    coordinates (longitude, latitude, height above a reference ellipsoid).</span>
<span class="sd">    Internally, the coordinates are stored as geocentric.</span>

<span class="sd">    To ensure a specific type of coordinates is used, use the corresponding</span>
<span class="sd">    class methods (`from_geocentric` and `from_geodetic`) or initialize the</span>
<span class="sd">    arguments with names (``x``, ``y``, ``z`` for geocentric; ``lon``, ``lat``,</span>
<span class="sd">    ``height`` for geodetic).  See the class methods for details.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    For conversion to and from geodetic coordinates, the ERFA routines</span>
<span class="sd">    ``gc2gd`` and ``gd2gc`` are used.  See https://github.com/liberfa/erfa</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_ellipsoid</span> <span class="o">=</span> <span class="s">&#39;WGS84&#39;</span>
    <span class="n">_location_dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="p">({</span><span class="s">&#39;names&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s">&#39;x&#39;</span><span class="p">,</span> <span class="s">&#39;y&#39;</span><span class="p">,</span> <span class="s">&#39;z&#39;</span><span class="p">],</span>
                                <span class="s">&#39;formats&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">})</span>
    <span class="n">_array_dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,)))</span>

    <span class="k">def</span> <span class="nf">__new__</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span> <span class="o">=</span> <span class="n">cls</span><span class="o">.</span><span class="n">from_geocentric</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">except</span> <span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">UnitsError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">)</span> <span class="k">as</span> <span class="n">exc_geocentric</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span> <span class="o">=</span> <span class="n">cls</span><span class="o">.</span><span class="n">from_geodetic</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exc_geodetic</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&#39;Coordinates could not be parsed as either &#39;</span>
                                <span class="s">&#39;geocentric or geodetic, with respective &#39;</span>
                                <span class="s">&#39;exceptions &quot;{0}&quot; and &quot;{1}&quot;&#39;</span>
                                <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">exc_geocentric</span><span class="p">,</span> <span class="n">exc_geodetic</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="nd">@classmethod</span>
<div class="viewcode-block" id="EarthLocation.from_geocentric"><a class="viewcode-back" href="../../../api/astropy.coordinates.EarthLocation.html#astropy.coordinates.EarthLocation.from_geocentric">[docs]</a>    <span class="k">def</span> <span class="nf">from_geocentric</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Location on Earth, initialized from geocentric coordinates.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x, y, z : `~astropy.units.Quantity` or array-like</span>
<span class="sd">            Cartesian coordinates.  If not quantities, ``unit`` should be given.</span>
<span class="sd">        unit : `~astropy.units.UnitBase` object or None</span>
<span class="sd">            Physical unit of the coordinate values.  If ``x``, ``y``, and/or</span>
<span class="sd">            ``z`` are quantities, they will be converted to this unit.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        astropy.units.UnitsError</span>
<span class="sd">            If the units on ``x``, ``y``, and ``z`` do not match or an invalid</span>
<span class="sd">            unit is given.</span>
<span class="sd">        ValueError</span>
<span class="sd">            If the shapes of ``x``, ``y``, and ``z`` do not match.</span>
<span class="sd">        TypeError</span>
<span class="sd">            If ``x`` is not a `~astropy.units.Quantity` and no unit is given.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">unit</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">unit</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">unit</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&quot;Geocentric coordinates should be Quantities &quot;</span>
                                <span class="s">&quot;unless an explicit unit is given.&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">unit</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">Unit</span><span class="p">(</span><span class="n">unit</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">unit</span><span class="o">.</span><span class="n">physical_type</span> <span class="o">!=</span> <span class="s">&#39;length&#39;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">u</span><span class="o">.</span><span class="n">UnitsError</span><span class="p">(</span><span class="s">&quot;Geocentric coordinates should be in &quot;</span>
                               <span class="s">&quot;units of length.&quot;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">u</span><span class="o">.</span><span class="n">UnitsError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">u</span><span class="o">.</span><span class="n">UnitsError</span><span class="p">(</span><span class="s">&quot;Geocentric coordinate units should all be &quot;</span>
                               <span class="s">&quot;consistent.&quot;</span><span class="p">)</span>

        <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">broadcast_arrays</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
        <span class="n">struc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">cls</span><span class="o">.</span><span class="n">_location_dtype</span><span class="p">)</span>
        <span class="n">struc</span><span class="p">[</span><span class="s">&#39;x&#39;</span><span class="p">],</span> <span class="n">struc</span><span class="p">[</span><span class="s">&#39;y&#39;</span><span class="p">],</span> <span class="n">struc</span><span class="p">[</span><span class="s">&#39;z&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">EarthLocation</span><span class="p">,</span> <span class="n">cls</span><span class="p">)</span><span class="o">.</span><span class="n">__new__</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">struc</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</div>
    <span class="nd">@classmethod</span>
<div class="viewcode-block" id="EarthLocation.from_geodetic"><a class="viewcode-back" href="../../../api/astropy.coordinates.EarthLocation.html#astropy.coordinates.EarthLocation.from_geodetic">[docs]</a>    <span class="k">def</span> <span class="nf">from_geodetic</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">ellipsoid</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Location on Earth, initialized from geodetic coordinates.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        lon : `~astropy.coordinates.Longitude` or float</span>
<span class="sd">            Earth East longitude.  Can be anything that initialises an</span>
<span class="sd">            `~astropy.coordinates.Angle` object (if float, in degrees).</span>
<span class="sd">        lat : `~astropy.coordinates.Latitude` or float</span>
<span class="sd">            Earth latitude.  Can be anything that initialises an</span>
<span class="sd">            `~astropy.coordinates.Latitude` object (if float, in degrees).</span>
<span class="sd">        height : `~astropy.units.Quantity` or float, optional</span>
<span class="sd">            Height above reference ellipsoid (if float, in meters; default: 0).</span>
<span class="sd">        ellipsoid : str, optional</span>
<span class="sd">            Name of the reference ellipsoid to use (default: &#39;WGS84&#39;).</span>
<span class="sd">            Available ellipoids are:  &#39;WGS84&#39;, &#39;GRS80&#39;, &#39;WGS72&#39;.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        astropy.units.UnitsError</span>
<span class="sd">            If the units on ``lon`` and ``lat`` are inconsistent with angular</span>
<span class="sd">            ones, or that on ``height`` with a length.</span>
<span class="sd">        ValueError</span>
<span class="sd">            If ``lon``, ``lat``, and ``height`` do not have the same shape, or</span>
<span class="sd">            if ``ellipsoid`` is not recognized as among the ones implemented.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        For the conversion to geocentric coordinates, the ERFA routine</span>
<span class="sd">        ``gd2gc`` is used.  See https://github.com/liberfa/erfa</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ellipsoid</span> <span class="o">=</span> <span class="n">_check_ellipsoid</span><span class="p">(</span><span class="n">ellipsoid</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">cls</span><span class="o">.</span><span class="n">_ellipsoid</span><span class="p">)</span>
        <span class="n">lon</span> <span class="o">=</span> <span class="n">Longitude</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">degree</span><span class="p">,</span> <span class="n">wrap_angle</span><span class="o">=</span><span class="mi">180</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">degree</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
        <span class="n">lat</span> <span class="o">=</span> <span class="n">Latitude</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">degree</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
        <span class="c"># don&#39;t convert to m by default, so we can use the height unit below.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">height</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">Quantity</span><span class="p">):</span>
            <span class="n">height</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="n">height</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">m</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
        <span class="c"># convert to float in units required for erfa routine, and ensure</span>
        <span class="c"># all broadcast to same shape, and are at least 1-dimensional.</span>
        <span class="n">_lon</span><span class="p">,</span> <span class="n">_lat</span><span class="p">,</span> <span class="n">_height</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">broadcast_arrays</span><span class="p">(</span><span class="n">lon</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">radian</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
                                                  <span class="n">lat</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">radian</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
                                                  <span class="n">height</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">m</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="c"># get geocentric coordinates. Have to give one-dimensional array.</span>
        <span class="n">xyz</span> <span class="o">=</span> <span class="n">erfa_time</span><span class="o">.</span><span class="n">era_gd2gc</span><span class="p">(</span><span class="n">ELLIPSOIDS</span><span class="p">[</span><span class="n">ellipsoid</span><span class="p">],</span> <span class="n">_lon</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span>
                                  <span class="n">_lat</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">_height</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span>
        <span class="bp">self</span> <span class="o">=</span> <span class="n">xyz</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">_location_dtype</span><span class="p">,</span> <span class="n">cls</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">lon</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_unit</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">meter</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ellipsoid</span> <span class="o">=</span> <span class="n">ellipsoid</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">height</span><span class="o">.</span><span class="n">unit</span><span class="p">)</span>
</div>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">ellipsoid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The default ellipsoid used to convert to geodetic coordinates.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ellipsoid</span>

    <span class="nd">@ellipsoid.setter</span>
    <span class="k">def</span> <span class="nf">ellipsoid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ellipsoid</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ellipsoid</span> <span class="o">=</span> <span class="n">_check_ellipsoid</span><span class="p">(</span><span class="n">ellipsoid</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">geodetic</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Convert to geodetic coordinates for the default ellipsoid.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_geodetic</span><span class="p">()</span>

<div class="viewcode-block" id="EarthLocation.to_geodetic"><a class="viewcode-back" href="../../../api/astropy.coordinates.EarthLocation.html#astropy.coordinates.EarthLocation.to_geodetic">[docs]</a>    <span class="k">def</span> <span class="nf">to_geodetic</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ellipsoid</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Convert to geodetic coordinates.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ellipsoid : str, optional</span>
<span class="sd">            Reference ellipsoid to use.  Default is the one the coordinates</span>
<span class="sd">            were initialized with.  Available are: &#39;WGS84&#39;, &#39;GRS80&#39;, &#39;WGS72&#39;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        (lon, lat, height) : tuple</span>
<span class="sd">            The tuple contains instances of `~astropy.coordinates.Longitude`,</span>
<span class="sd">            `~astropy.coordinates.Latitude`, and `~astropy.units.Quantity`</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            if ``ellipsoid`` is not recognized as among the ones implemented.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        For the conversion to geodetic coordinates, the ERFA routine</span>
<span class="sd">        ``gc2gd`` is used.  See https://github.com/liberfa/erfa</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ellipsoid</span> <span class="o">=</span> <span class="n">_check_ellipsoid</span><span class="p">(</span><span class="n">ellipsoid</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ellipsoid</span><span class="p">)</span>
        <span class="n">self_array</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">meter</span><span class="p">)</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_array_dtype</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span>
        <span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="n">erfa_time</span><span class="o">.</span><span class="n">era_gc2gd</span><span class="p">(</span><span class="n">ELLIPSOIDS</span><span class="p">[</span><span class="n">ellipsoid</span><span class="p">],</span>
                                               <span class="n">np</span><span class="o">.</span><span class="n">atleast_2d</span><span class="p">(</span><span class="n">self_array</span><span class="p">))</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">Longitude</span><span class="p">(</span><span class="n">lon</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">radian</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">degree</span><span class="p">,</span>
                          <span class="n">wrap_angle</span><span class="o">=</span><span class="mf">180.</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">degree</span><span class="p">),</span>
                <span class="n">Latitude</span><span class="p">(</span><span class="n">lat</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">radian</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">degree</span><span class="p">),</span>
                <span class="n">u</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="n">height</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">meter</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span><span class="p">))</span>
</div>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">longitude</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Longitude of the location, for the default ellipsoid.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">geodetic</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">latitude</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Latitude of the location, for the default ellipsoid.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">geodetic</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">height</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Height of the location, for the default ellipsoid.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">geodetic</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

    <span class="c"># mostly for symmetry with geodedic and to_geodetic.</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">geocentric</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Convert to a tuple with X, Y, and Z as quantities&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_geocentric</span><span class="p">()</span>

<div class="viewcode-block" id="EarthLocation.to_geocentric"><a class="viewcode-back" href="../../../api/astropy.coordinates.EarthLocation.html#astropy.coordinates.EarthLocation.to_geocentric">[docs]</a>    <span class="k">def</span> <span class="nf">to_geocentric</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Convert to a tuple with X, Y, and Z as quantities&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>
</div>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">x</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The X component of the geocentric coordinates.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="s">&#39;x&#39;</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">y</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The Y component of the geocentric coordinates.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="s">&#39;y&#39;</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">z</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The Z component of the geocentric coordinates.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="s">&#39;z&#39;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">EarthLocation</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__getitem__</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">is</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">Quantity</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__array_finalize__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">EarthLocation</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__array_finalize__</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s">&#39;_ellipsoid&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_ellipsoid</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">_ellipsoid</span>

    <span class="k">def</span> <span class="nf">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">():</span>
            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s">&#39;0-d EarthLocation arrays cannot be indexed&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">EarthLocation</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__len__</span><span class="p">()</span>

<div class="viewcode-block" id="EarthLocation.to"><a class="viewcode-back" href="../../../api/astropy.coordinates.EarthLocation.html#astropy.coordinates.EarthLocation.to">[docs]</a>    <span class="k">def</span> <span class="nf">to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">equivalencies</span><span class="o">=</span><span class="p">[]):</span>
        <span class="n">array_view</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_array_dtype</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">Quantity</span><span class="p">)</span>
        <span class="n">converted</span> <span class="o">=</span> <span class="n">array_view</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span> <span class="n">equivalencies</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_new_view</span><span class="p">(</span><span class="n">converted</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">),</span>
                              <span class="n">unit</span><span class="p">)</span></div>
    <span class="n">to</span><span class="o">.</span><span class="n">__doc__</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">Quantity</span><span class="o">.</span><span class="n">to</span><span class="o">.</span><span class="n">__doc__</span></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right"> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2011-2014, The Astropy Developers.<br/>
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2.2. &nbsp;
    Last built 29 Jul 2014. <br/>
  </p>
</footer>
  </body>
</html>